<!DOCTYPE html>
<html>
<head>
  <title>Per Diem Search Page</title>
  <style>
    /* Add some space around the page */
    body {
      padding: 20px;
    }

    /* Style the table */
    table {
      width: 100%; /* Make the table take up the full width of its container */
      border-collapse: collapse; /* Collapse borders */
    }

    /* Style the table headers */
    th {
      background-color: #f8f8f8; /* Light gray background */
      text-align: left; /* Left-align text */
      padding: 8px; /* Add some padding */
    }

    /* Style the table cells */
    td {
      border: 1px solid #ddd; /* Add a border */
      padding: 8px; /* Add some padding */
    }

    /* Add a hover effect to table rows */
    tr:hover {
      background-color: #f5f5f5;
    }
  </style>
  <script>
    function searchData() {
      const query = document.getElementById('search').value.toLowerCase();
      const url = `http://maxcashpcs.infinityfreeapp.com/api2.php?q=${query}`;
      const tbody = document.getElementById('results-body');

      console.log('Search query:', query); // Log the search query

      // Check if tbody exists
      if (!tbody) {
        console.error('tbody element not found');
        return;
      }

      // Check if query is empty
      if (!query) {
        tbody.innerHTML = '<tr><td colspan="8">No results found</td></tr>';
        return;
      }

      fetch(url)
        .then(response => {
          console.log('Response:', response); // Log the response
          return response.json();
        })
        .then(data => {
          console.log('Received data:', data); // Log the received data

          // Convert data to an array if it's an object
          if (data && typeof data === 'object' && !Array.isArray(data)) {
            data = Object.values(data);
          }

          // Check if data is defined and is an array
          if (data && Array.isArray(data)) {
            // Check if data is empty
            if (data.length === 0) {
              // Display "No results found" message
              tbody.innerHTML = '<tr><td colspan="8">No results found</td></tr>';
            } else {
              // Clear the tbody
              tbody.innerHTML = '';

              // Loop through the results and add them to the table
              data.forEach(item => {
                const tr = document.createElement('tr');
                ['ID', 'STATE', 'DESTINATION', 'COUNTY_LOCATION', 'SEASON_BEGIN', 'SEASON_END', 'LODGING_RATE', 'MEALS_RATE'].forEach(key => {
                  const td = document.createElement('td');
                  td.textContent = item[key];
                  tr.appendChild(td);
                });
                tbody.appendChild(tr);
              });
            }
          }
        })
        .catch(error => console.error('Error:', error));
    }
  </script>
</head>
<body>
  <h1>Per Diem Search</h1>
  <input type="text" id="search" placeholder="Enter search query">
  <button onclick="searchData()">Search</button>
  <table id="results">
    <thead>
      <tr>
        <th>ID</th>
        <th>State</th>
        <th>Destination</th>
        <th>County Location</th>
        <th>Season Begin</th>
        <th>Season End</th>
        <th>Lodging Rate</th>
        <th>Meals Rate</th>
      </tr>
    </thead>
    <tbody id="results-body">
    </tbody>
  </table>
</body>
</html>